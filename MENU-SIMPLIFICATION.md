# èœå•ç®€åŒ–å’ŒåŠŸèƒ½ä¼˜åŒ–

## æ›´æ–°æ—¥æœŸ
**æ—¥æœŸ**: 2024-12-30  
**ç‰ˆæœ¬**: 1.0.3

## ðŸŽ¯ æ›´æ–°å†…å®¹

### 1. èœå•ç®€åŒ– âœ…

**æ—§èœå•**ï¼ˆ10ä¸ªé€‰é¡¹ï¼‰ï¼š
```
ðŸ”§ é‡è£…å‰å·¥å…·
  [1] æ£€æµ‹ç³»ç»Ÿä¿¡æ¯
  [2] å¤‡ä»½å½“å‰é…ç½®
  [3] è§„åˆ’ç½‘ç»œé…ç½®
  [4] ç”Ÿæˆé‡è£…è„šæœ¬

ðŸš€ é‡è£…åŽå·¥å…·
  [5] åŸºç¡€é…ç½®
  [6] ç½‘ç»œé…ç½®
  [7] ç³»ç»Ÿé…ç½®
  [8] K3s éƒ¨ç½²

ðŸ“Š å®žç”¨å·¥å…·
  [9] æŸ¥çœ‹éƒ¨ç½²æŠ¥å‘Š
  [10] å®‰å…¨æ¸…ç†
```

**æ–°èœå•**ï¼ˆ8ä¸ªé€‰é¡¹ï¼‰ï¼š
```
ðŸ”§ é‡è£…å‰å·¥å…·
  [1] é‡è£…å‡†å¤‡å‘å¯¼
  [2] ç”Ÿæˆé‡è£…è„šæœ¬

ðŸš€ é‡è£…åŽå·¥å…·
  [3] åŸºç¡€é…ç½®
  [4] ç½‘ç»œé…ç½®
  [5] ç³»ç»Ÿé…ç½®
  [6] K3s éƒ¨ç½²

ðŸ“Š å®žç”¨å·¥å…·
  [7] æŸ¥çœ‹éƒ¨ç½²æŠ¥å‘Š
  [8] å®‰å…¨æ¸…ç†
```

### 2. åŠŸèƒ½åˆå¹¶ âœ…

#### æ—§çš„3ä¸ªåŠŸèƒ½ï¼ˆé‡å¤ä¸”æ··ä¹±ï¼‰
- [1] æ£€æµ‹ç³»ç»Ÿä¿¡æ¯ - åªæ£€æµ‹ï¼Œä¸ç”Ÿæˆå¯ç”¨çš„é…ç½®
- [2] å¤‡ä»½å½“å‰é…ç½® - å¤‡ä»½ä»€ä¹ˆï¼Ÿæ€Žä¹ˆç”¨ï¼Ÿ
- [3] è§„åˆ’ç½‘ç»œé…ç½® - é‡è£…å‰è§„åˆ’æ²¡æœ‰æ„ä¹‰

#### æ–°çš„1ä¸ªåŠŸèƒ½ï¼ˆæ¸…æ™°ä¸”å®žç”¨ï¼‰
- [1] **é‡è£…å‡†å¤‡å‘å¯¼** - ä¸€ç«™å¼å®Œæˆæ‰€æœ‰å‡†å¤‡å·¥ä½œ
  - æ£€æµ‹ç³»ç»Ÿä¿¡æ¯
  - å¤‡ä»½ç½‘ç»œé…ç½®
  - **ç”Ÿæˆæ¢å¤è„šæœ¬**ï¼ˆé‡è£…åŽå¯ç›´æŽ¥è¿è¡Œï¼‰
  - ç”Ÿæˆå¤‡ä»½ä¿¡æ¯æ–‡ä»¶

### 3. é‡è£…è„šæœ¬ä¼˜åŒ– âœ…

#### æ—§çš„"ç”Ÿæˆé‡è£…è„šæœ¬"
- è‡ªåŠ¨ä½¿ç”¨å½“å‰ç³»ç»Ÿä¿¡æ¯
- ç”¨æˆ·æ— æ³•é€‰æ‹©è¦å®‰è£…çš„ç³»ç»Ÿ
- éœ€è¦æ‰‹åŠ¨ç¼–è¾‘è„šæœ¬

#### æ–°çš„"ç”Ÿæˆé‡è£…è„šæœ¬"
- **äº¤äº’å¼é€‰æ‹©**è¦å®‰è£…çš„ç³»ç»Ÿ
- æ”¯æŒ 8 ç§ä¸»æµ Linux å‘è¡Œç‰ˆ
- è‡ªåŠ¨ç”Ÿæˆå®Œæ•´çš„é‡è£…è„šæœ¬
- åŒ…å«å®‰å…¨ç¡®è®¤æœºåˆ¶

## ðŸ“‹ æ–°åŠŸèƒ½è¯¦è§£

### åŠŸèƒ½ 1ï¼šé‡è£…å‡†å¤‡å‘å¯¼

**æ–‡ä»¶**: `pre-reinstall/prepare-wizard.sh`

**åŠŸèƒ½**ï¼š
1. æ£€æµ‹å½“å‰ç³»ç»Ÿä¿¡æ¯
   - æ“ä½œç³»ç»Ÿã€ç‰ˆæœ¬ã€æž¶æž„
   - ç½‘ç»œé…ç½®ï¼ˆIPã€ç½‘å…³ã€DNSï¼‰
   - ä¸»æœºåï¼ˆçŸ­åå’Œ FQDNï¼‰

2. ç”Ÿæˆæ¢å¤è„šæœ¬
   - æ–‡ä»¶åï¼š`~/restore-config-YYYYMMDD_HHMMSS.sh`
   - å†…å®¹ï¼šå¯ç›´æŽ¥åœ¨é‡è£…åŽè¿è¡Œçš„å‘½ä»¤
   - åŠŸèƒ½ï¼šæ¢å¤ç½‘ç»œé…ç½®ã€ä¸»æœºåã€DNS

3. ç”Ÿæˆå¤‡ä»½ä¿¡æ¯
   - æ–‡ä»¶åï¼š`~/backup-info-YYYYMMDD_HHMMSS.txt`
   - å†…å®¹ï¼šç³»ç»Ÿä¿¡æ¯ã€ç½‘ç»œé…ç½®ã€é‡è¦æ–‡ä»¶åˆ—è¡¨

**ç”Ÿæˆçš„æ¢å¤è„šæœ¬ç¤ºä¾‹**ï¼š
```bash
#!/usr/bin/env bash
# Configuration Restore Script

# Restore network
ip addr add 192.168.1.100/24 dev eth0
ip route add default via 192.168.1.1

# Restore hostname
hostnamectl set-hostname server01.example.com

# Restore DNS
cat > /etc/resolv.conf << EOF
nameserver 8.8.8.8
nameserver 8.8.4.4
EOF
```

**ä½¿ç”¨æµç¨‹**ï¼š
```bash
# 1. é‡è£…å‰è¿è¡Œ
[1] é‡è£…å‡†å¤‡å‘å¯¼

# 2. ä¿å­˜ç”Ÿæˆçš„æ–‡ä»¶
~/restore-config-20241230_144736.sh
~/backup-info-20241230_144736.txt

# 3. é‡è£…åŽè¿è¡Œ
bash ~/restore-config-20241230_144736.sh
```

### åŠŸèƒ½ 2ï¼šç”Ÿæˆé‡è£…è„šæœ¬

**æ–‡ä»¶**: `pre-reinstall/reinstall-os.sh`

**åŠŸèƒ½**ï¼š
1. äº¤äº’å¼é€‰æ‹©æ“ä½œç³»ç»Ÿ
   - Debian (11, 12)
   - Ubuntu (20.04, 22.04, 24.04)
   - Rocky Linux (8, 9)
   - AlmaLinux (8, 9)
   - Alpine Linux
   - Arch Linux
   - Fedora (39, 40)
   - openSUSE Leap

2. ç”Ÿæˆé‡è£…è„šæœ¬
   - æ–‡ä»¶åï¼š`~/reinstall-os-YYYYMMDD_HHMMSS.sh`
   - åŒ…å«ç”¨æˆ·é€‰æ‹©çš„ç³»ç»Ÿå’Œç‰ˆæœ¬
   - åŒ…å«å®‰å…¨ç¡®è®¤æœºåˆ¶
   - è‡ªåŠ¨ä¸‹è½½é‡è£…å·¥å…·

**äº¤äº’æµç¨‹**ï¼š
```
é€‰æ‹©è¦å®‰è£…çš„æ“ä½œç³»ç»Ÿï¼š
  [1] Debian
  [2] Ubuntu
  [3] Rocky Linux
  ...

æ‚¨é€‰æ‹©äº†ï¼šDebian

é€‰æ‹© Debian ç‰ˆæœ¬:
  [1] Debian 11 (Bullseye)
  [2] Debian 12 (Bookworm)

æ‚¨é€‰æ‹©äº†ï¼šDebian 12

ç¡®è®¤? [y/N] y

ç”Ÿæˆé‡è£…è„šæœ¬ï¼š~/reinstall-os-20241230_144736.sh
```

**ç”Ÿæˆçš„é‡è£…è„šæœ¬ç¤ºä¾‹**ï¼š
```bash
#!/usr/bin/env bash
# OS Reinstall Script
# Target: debian 12

# Safety checks
check_root
check_network
confirm_reinstall  # éœ€è¦è¾“å…¥ YES å’Œ REINSTALL

# Download and execute
bash /tmp/reinstall-tool.sh debian 12
```

## ðŸš€ å®Œæ•´ä½¿ç”¨æµç¨‹

### æ­¥éª¤ 1ï¼šé‡è£…å‰å‡†å¤‡

```bash
# è¿è¡Œ server-toolkit
curl -fsSL https://raw.githubusercontent.com/k3s-forge/server-toolkit/main/bootstrap.sh | bash

# é€‰æ‹©è¯­è¨€
[2] ä¸­æ–‡

# é€‰æ‹©åŠŸèƒ½
[1] é‡è£…å‡†å¤‡å‘å¯¼

# ç”Ÿæˆçš„æ–‡ä»¶
~/restore-config-20241230_144736.sh  # æ¢å¤è„šæœ¬
~/backup-info-20241230_144736.txt    # å¤‡ä»½ä¿¡æ¯
```

**ä¿å­˜è¿™ä¸¤ä¸ªæ–‡ä»¶åˆ°å®‰å…¨ä½ç½®ï¼**

### æ­¥éª¤ 2ï¼šç”Ÿæˆé‡è£…è„šæœ¬

```bash
# åœ¨ server-toolkit ä¸­é€‰æ‹©
[2] ç”Ÿæˆé‡è£…è„šæœ¬

# é€‰æ‹©ç³»ç»Ÿ
[1] Debian

# é€‰æ‹©ç‰ˆæœ¬
[2] Debian 12

# ç¡®è®¤
y

# ç”Ÿæˆçš„æ–‡ä»¶
~/reinstall-os-20241230_144736.sh  # é‡è£…è„šæœ¬
```

### æ­¥éª¤ 3ï¼šæ‰§è¡Œé‡è£…

```bash
# è¿è¡Œé‡è£…è„šæœ¬
bash ~/reinstall-os-20241230_144736.sh

# ç¡®è®¤ï¼ˆéœ€è¦è¾“å…¥ä¸¤æ¬¡ï¼‰
Type 'YES' to continue: YES
Type 'REINSTALL' to confirm: REINSTALL

# ç³»ç»Ÿå¼€å§‹é‡è£…
# ç­‰å¾… 5-30 åˆ†é’Ÿ
# ç³»ç»Ÿè‡ªåŠ¨é‡å¯
```

### æ­¥éª¤ 4ï¼šé‡è£…åŽæ¢å¤

```bash
# ç™»å½•æ–°ç³»ç»Ÿ

# è¿è¡Œæ¢å¤è„šæœ¬
bash ~/restore-config-20241230_144736.sh

# æ¢å¤ç½‘ç»œé…ç½®
# æ¢å¤ä¸»æœºå
# æ¢å¤ DNS

# éªŒè¯
ping 8.8.8.8
ping google.com
```

### æ­¥éª¤ 5ï¼šç»§ç»­é…ç½®

```bash
# è¿è¡Œ server-toolkit
curl -fsSL https://raw.githubusercontent.com/k3s-forge/server-toolkit/main/bootstrap.sh | bash

# ä½¿ç”¨åŽç»­å·¥å…·
[3] åŸºç¡€é…ç½®
[4] ç½‘ç»œé…ç½®
[5] ç³»ç»Ÿé…ç½®
[6] K3s éƒ¨ç½²
```

## ðŸ“Š å¯¹æ¯”åˆ†æž

### æ—§æ–¹æ¡ˆçš„é—®é¢˜

1. **åŠŸèƒ½é‡å¤**
   - æ£€æµ‹ç³»ç»Ÿã€å¤‡ä»½é…ç½®ã€è§„åˆ’ç½‘ç»œéƒ½åœ¨æ”¶é›†ä¿¡æ¯
   - æ²¡æœ‰æ˜Žç¡®çš„è¾“å‡ºå’Œç”¨é€”

2. **ä¸å®žç”¨**
   - å¤‡ä»½çš„å†…å®¹ä¸èƒ½ç›´æŽ¥ä½¿ç”¨
   - è§„åˆ’ç½‘ç»œé…ç½®åœ¨é‡è£…å‰æ²¡æœ‰æ„ä¹‰
   - éœ€è¦æ‰‹åŠ¨æ•´ç†å’Œç¼–è¾‘

3. **ç”¨æˆ·å›°æƒ‘**
   - ä¸çŸ¥é“è¯¥é€‰å“ªä¸ª
   - ä¸çŸ¥é“ç”Ÿæˆçš„æ–‡ä»¶æ€Žä¹ˆç”¨
   - æ­¥éª¤ä¸æ¸…æ™°

### æ–°æ–¹æ¡ˆçš„ä¼˜åŠ¿

1. **åŠŸèƒ½æ¸…æ™°**
   - [1] å‡†å¤‡ï¼šç”Ÿæˆæ¢å¤è„šæœ¬
   - [2] é‡è£…ï¼šç”Ÿæˆé‡è£…è„šæœ¬
   - ç›®çš„æ˜Žç¡®ï¼Œæ­¥éª¤æ¸…æ™°

2. **å®žç”¨æ€§å¼º**
   - æ¢å¤è„šæœ¬å¯ç›´æŽ¥è¿è¡Œ
   - é‡è£…è„šæœ¬åŒ…å«ç”¨æˆ·é€‰æ‹©
   - æ— éœ€æ‰‹åŠ¨ç¼–è¾‘

3. **ç”¨æˆ·å‹å¥½**
   - äº¤äº’å¼é€‰æ‹©
   - æ¸…æ™°çš„æç¤º
   - å®Œæ•´çš„æµç¨‹æŒ‡å¯¼

## âœ… æŠ€æœ¯æ”¹è¿›

### 1. å®Œæ•´çš„ i18n æ”¯æŒ

æ‰€æœ‰æ–°è„šæœ¬éƒ½ä½¿ç”¨ i18n å‡½æ•°ï¼š
```bash
i18n_info "detect_os"
i18n_success "script_generated"
i18n_warn "warning"
i18n_error "error"
```

### 2. ç»Ÿä¸€çš„è„šæœ¬ç»“æž„

```bash
# Load common header
source "$SCRIPT_DIR/utils/common-header.sh"

# Main functions
function1() { ... }
function2() { ... }

# Main entry
main() { ... }

# Run if executed directly
if [[ "${BASH_SOURCE[0]}" == "${0}" ]]; then
    main "$@"
fi
```

### 3. å®‰å…¨æœºåˆ¶

- Root æƒé™æ£€æŸ¥
- ç½‘ç»œè¿žæŽ¥æ£€æŸ¥
- åŒé‡ç¡®è®¤æœºåˆ¶
- æ¸…æ™°çš„è­¦å‘Šä¿¡æ¯

## ðŸ“š ç›¸å…³æ–‡æ¡£

- [README.md](README.md) - é¡¹ç›®ä¸»æ–‡æ¡£
- [README.zh.md](README.zh.md) - ä¸­æ–‡ä¸»æ–‡æ¡£
- [REINSTALL-SCRIPT-GUIDE.md](REINSTALL-SCRIPT-GUIDE.md) - é‡è£…è„šæœ¬æŒ‡å—
- [LANGUAGE-SELECTION-UPDATE.md](LANGUAGE-SELECTION-UPDATE.md) - è¯­è¨€é€‰æ‹©æ›´æ–°

## ðŸŽ‰ æ€»ç»“

**v1.0.3 æ›´æ–°å®Œæˆï¼**

### ä¸»è¦æ”¹è¿›
1. âœ… **èœå•ç®€åŒ–** - ä»Ž 10 ä¸ªé€‰é¡¹å‡å°‘åˆ° 8 ä¸ª
2. âœ… **åŠŸèƒ½åˆå¹¶** - 3 ä¸ªé‡å¤åŠŸèƒ½åˆå¹¶ä¸º 1 ä¸ªå®žç”¨åŠŸèƒ½
3. âœ… **äº¤äº’ä¼˜åŒ–** - ç”¨æˆ·å¯ä»¥é€‰æ‹©è¦å®‰è£…çš„ç³»ç»Ÿ
4. âœ… **å®žç”¨æ€§æå‡** - ç”Ÿæˆå¯ç›´æŽ¥ä½¿ç”¨çš„æ¢å¤è„šæœ¬
5. âœ… **å®Œæ•´ i18n** - æ‰€æœ‰æ–°è„šæœ¬éƒ½æ”¯æŒä¸­è‹±æ–‡

### ç”¨æˆ·ä½“éªŒæå‡
- æ›´æ¸…æ™°çš„åŠŸèƒ½åˆ’åˆ†
- æ›´ç®€æ´çš„èœå•
- æ›´å®žç”¨çš„è¾“å‡º
- æ›´å‹å¥½çš„äº¤äº’

---

**æ›´æ–°å®Œæˆæ—¥æœŸ**: 2024-12-30  
**é¡¹ç›®ç‰ˆæœ¬**: 1.0.3  
**çŠ¶æ€**: âœ… èœå•ç®€åŒ–å®Œæˆ

